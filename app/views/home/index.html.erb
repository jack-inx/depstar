<script type="text/javascript">
$(window).load(function(){

    // We are listening to the window.load event, so we can be sure
    // that the images in the slideshow are loaded properly.

    // Testing wether the current browser supports the canvas element:
    var supportCanvas = 'getContext' in document.createElement('canvas');

    // The canvas manipulations of the images are CPU intensive,
    // this is why we are using setTimeout to make them asynchronous
    // and improve the responsiveness of the page.

    var slides = $('#slideshow li'),
        current = 0,
        slideshow = {width:0,height:0};

    setTimeout(function(){

        if(supportCanvas){
            $('#slideshow img').each(function(){

                if(!slideshow.width){
                    // Saving the dimensions of the first image:
                    slideshow.width = this.width;
                    slideshow.height = this.height;
                }

                // Rendering the modified versions of the images:
                createCanvasOverlay(this);
            });
        }

        $('#slideshow .arrow').click(function(){
            var li            = slides.eq(current),
                canvas        = li.find('canvas'),
                nextIndex    = 0;

            // Depending on whether this is the next or previous
            // arrow, calculate the index of the next slide accordingly.

            if($(this).hasClass('next')){
                nextIndex = current >= slides.length-1 ? 0 : current+1;
            }
            else {
                nextIndex = current <= 0 ? slides.length-1 : current-1;
            }

            var next = slides.eq(nextIndex);

            if(supportCanvas){

                // This browser supports canvas, fade it into view:

                canvas.fadeIn(function(){

                    // Show the next slide below the current one:
                    next.show();
                    current = nextIndex;

                    // Fade the current slide out of view:
                    li.fadeOut(function(){
                        li.removeClass('slideActive');
                        canvas.hide();
                        next.addClass('slideActive');
                    });
                });
            }
            else {

                // This browser does not support canvas.
                // Use the plain version of the slideshow.

                current=nextIndex;
                next.addClass('slideActive').show();
                li.removeClass('slideActive').hide();
            }
        });

    },100);
</script>
<%= javascript_include_tag 'autoadvance.js', 'script.js' %>
<%= form_for :product, :url => { :controller => "products", :action => "search" }, :html => { :class => 'cash-form' } do |f|%>	
	<fieldset>
		<label for="text">Get Cash Now!</label>
		<div class="text">
			<%= autocomplete_field_tag 'name', '', home_autocomplete_product_name_path, :size => 75, :value => "example: Apple iPhone 4", :class => 'cleardefault' %>
		</div>
		<%= f.submit :class => 'btn-go' %>
	</fieldset>
<% end %>
<div id="sidebar">
	<ul class="list-categories">
		<% @categories.each do |category| %>
			<li>
			<%= link_to(category) do %>
			    <span><%= category.name %></span>
			  <% end %>
			</li>
		<% end %>
	</ul>
	<%= link_to 'See all categories', categories_path, :class => 'all-categories' %>
</div>
<div class="content-holder">
	<div class="products-holder">
		<div class="t">
			<div class="b">
				<div class="products-box">

						<div id="slideshow">

						    <ul class="slides">
						        <li><img src="images/slideshow/1.jpg" width="584" height="298" alt="Sell in 3 Easy Steps" /></li>
						        <li><img src="images/slideshow/2.jpg" width="584" height="298" alt="No Risk" /></li>
						        <li><img src="images/slideshow/3.jpg" width="584" height="298" alt="We Pay 10% More on Average Than Any Other Company" /></li>
						        <li><img src="images/slideshow/4.jpg" width="584" height="298" alt="Get Paid and Help the Enviroment" /></li>
						    </ul>

						    <span class="arrow previous"></span>
						    <span class="arrow next"></span>
						</div>
						
					<div class="product">
						<h3>Just Sold Now</h3>
						<div class="image">
							<img src="images/img-9.gif" width="63" height="148" alt="image description" />
						</div>
						<div class="description">
							<p>A Depstar customer from Columbus, OH just got paid:</p>
							<span>$178</span>
							<p>For Their iPhone</p>
						</div>
						<div class="btn-sell-now">
							<%= link_to :controller => :products, :action => :search, :name => "iphone" do %>
								<span>Sell Your's Now</span>
							<% end %>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>